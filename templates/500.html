<!-- templates/500.html -->
{% extends "main/layout.html" %}

{% block title %}Ошибка сервера (500) - Аренда квартир{% endblock %}

{% block page_title %}Упс! Что-то пошло не так{% endblock %}

{% block page_subtitle %}Мы уже работаем над устранением проблемы{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8 text-center">
            <!-- Иллюстрация -->
            <div class="error-illustration mb-5">
                <div class="error-icon">
                    <i class="fas fa-tools fa-5x text-warning mb-4"></i>
                </div>
                <h1 class="display-1 fw-bold text-warning mb-3">500</h1>
            </div>

            <!-- Сообщение об ошибке -->
            <div class="error-content mb-5">
                <h2 class="h3 mb-3">Внутренняя ошибка сервера</h2>
                <p class="lead text-muted mb-4">
                    На сервере произошла непредвиденная ошибка. Мы уже уведомлены о проблеме 
                    и работаем над ее устранением. Пожалуйста, попробуйте позже.
                </p>

                <!-- Статус системы -->
                <div class="system-status mb-5">
                    <h4 class="h5 mb-3">Статус системы</h4>
                    <div class="row g-3 justify-content-center">
                        <div class="col-md-3">
                            <div class="status-item p-3 border rounded">
                                <div class="status-indicator bg-success rounded-circle mx-auto mb-2" 
                                     style="width: 20px; height: 20px;"></div>
                                <small>Сайт</small>
                                <div class="fw-bold text-success">Работает</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="status-item p-3 border rounded">
                                <div class="status-indicator bg-danger rounded-circle mx-auto mb-2" 
                                     style="width: 20px; height: 20px;"></div>
                                <small>База данных</small>
                                <div class="fw-bold text-danger">Ошибка</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="status-item p-3 border rounded">
                                <div class="status-indicator bg-success rounded-circle mx-auto mb-2" 
                                     style="width: 20px; height: 20px;"></div>
                                <small>Поиск</small>
                                <div class="fw-bold text-success">Работает</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Кнопки действий -->
                <div class="error-actions mb-5">
                    <div class="row g-3 justify-content-center">
                        <div class="col-auto">
                            <a href="{% url 'post-list' %}" class="btn btn-primary btn-lg">
                                <i class="fas fa-home me-2"></i>На главную
                            </a>
                        </div>
                        <div class="col-auto">
                            <button onclick="location.reload()" class="btn btn-warning btn-lg">
                                <i class="fas fa-redo me-2"></i>Обновить страницу
                            </button>
                        </div>
                        <div class="col-auto">
                            <button onclick="history.back()" class="btn btn-outline-secondary btn-lg">
                                <i class="fas fa-arrow-left me-2"></i>Назад
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Таймер автоматического обновления -->
                <div class="auto-refresh mb-4">
                    <p class="text-muted small">
                        Автоматическое обновление через: 
                        <span id="countdown" class="fw-bold">30</span> секунд
                    </p>
                </div>
            </div>

            <!-- Контакты поддержки -->
            <div class="support-info bg-light rounded p-4">
                <h4 class="h5 mb-3">Техническая поддержка</h4>
                <p class="text-muted mb-3">
                    Если проблема повторяется, свяжитесь с нашей технической поддержкой.
                </p>
                <div class="row g-3">
                    <div class="col-md-6">
                        <a href="mailto:tech@arenda.ru" class="btn btn-outline-primary w-100">
                            <i class="fas fa-envelope me-2"></i>Техподдержка
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="tel:+78001234567" class="btn btn-outline-success w-100">
                            <i class="fas fa-phone me-2"></i>8-800-123-45-67
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Таймер автоматического обновления
let countdown = 30;
const countdownElement = document.getElementById('countdown');

const timer = setInterval(function() {
    countdown--;
    countdownElement.textContent = countdown;
    
    if (countdown <= 0) {
        clearInterval(timer);
        location.reload();
    }
}, 1000);
</script>

<style>
.error-illustration {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.status-item {
    transition: all 0.3s ease;
}

.status-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

.status-indicator {
    animation: blink 2s infinite;
}

@keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0.3; }
}

@media (max-width: 768px) {
    .display-1 {
        font-size: 5rem;
    }
}
</style>
{% endblock %}